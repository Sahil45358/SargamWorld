<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SurSargam ‚Äì Harmonium</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .harmonium-wrap {
      max-width: 1200px;
      margin: 3rem auto;
      text-align: center;
    }

    #noteDisplay {
      font-size: 1.2rem;
      font-weight: bold;
      margin-bottom: 1.5rem;
      color: #c31432;
    }

    #harmonium {
      position: relative;
      display: flex;
      justify-content: center;
      align-items: flex-end;
      height: 200px;
      margin: 2rem 0;
    }

    .white-key {
      width: 60px;
      height: 200px;
      background: #fff8e1;
      border: 2px solid #5d4037;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      border-radius: 0 0 5px 5px;
      margin: 0 1px;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: flex-end;
      font-weight: bold;
      font-size: 0.8rem;
      font-family: 'Verdana', sans-serif;
      user-select: none;
      cursor: pointer;
    }

    .black-key {
      width: 40px;
      height: 120px;
      background: #2b2b2b;
      position: absolute;
      top: 0;
      z-index: 2;
      border: 1px solid #000;
      border-radius: 0 0 5px 5px;
      cursor: pointer;
    }

    .white-key:hover {
      background-color: #fff3c1;
    }

    .black-key:active {
      background-color: #444;
    }
  </style>
</head>
<body>
  <header>
    <h1>üéπ SurSargam ‚Äì Harmonium</h1>
    <p>Click any key to hear its pitch</p>
  </header>

  <main class="harmonium-wrap">
    <div id="noteDisplay">Click a key‚Ä¶</div>
    <div id="harmonium"></div>
    <p><a href="index.html">‚¨ÖÔ∏è Back to Home</a></p>
  </main>

  <footer>
    <p>üé∂ SurSargam ‚Ä¢ Interactive Harmonium with C2‚ÄìC4 Octaves.</p>
  </footer>

<script>
const harmonium = document.getElementById('harmonium');
const display = document.getElementById('noteDisplay');
const ctx = new (window.AudioContext || window.webkitAudioContext)();

const whiteNotes = ['C', 'D', 'E', 'F', 'G', 'A', 'B'];
const blackNotes = ['C#', 'D#', '', 'F#', 'G#', 'A#', ''];
const semitoneSteps = {
  'C': 0, 'C#': 1, 'D': 2, 'D#': 3, 'E': 4,
  'F': 5, 'F#': 6, 'G': 7, 'G#': 8, 'A': 9, 'A#': 10, 'B': 11
};
const baseFreq = 65.41; // C2

let whiteKeyCount = 0;

for (let octave = 2; octave <= 4; octave++) {
  for (let i = 0; i < whiteNotes.length; i++) {
    const note = whiteNotes[i];
    const noteId = note + octave;

    const key = document.createElement('div');
    key.className = 'white-key';
    if (note === 'C') key.innerText = noteId;
    key.dataset.note = noteId;

    harmonium.appendChild(key);

    const step = semitoneSteps[note] + (octave - 2) * 12;
    const freq = baseFreq * Math.pow(2, step / 12);

    key.onclick = () => playNote(noteId, freq);

    // Position black keys in between correct white keys
    const blackNote = blackNotes[i];
    if (blackNote !== '') {
      const black = document.createElement('div');
      black.className = 'black-key';
      black.dataset.note = blackNote + octave;

      const blackStep = semitoneSteps[blackNote] + (octave - 2) * 12;
      const blackFreq = baseFreq * Math.pow(2, blackStep / 12);

      black.onclick = () => playNote(black.dataset.note, blackFreq);

      // Offset from left based on white key width
      black.style.left = (whiteKeyCount * 62 + 45) + 'px';
      harmonium.appendChild(black);
    }

    whiteKeyCount++;
  }
}

function playNote(label, frequency) {
  display.textContent = 'üéµ ' + label;
  const osc = ctx.createOscillator();
  const gain = ctx.createGain();
  osc.type = 'sine'; // Replace this with 'triangle' or better if using samples
  osc.frequency.value = frequency;

  gain.gain.setValueAtTime(0.001, ctx.currentTime);
  gain.gain.exponentialRampToValueAtTime(0.4, ctx.currentTime + 0.01);
  gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 1.2);

  osc.connect(gain).connect(ctx.destination);
  osc.start();
  osc.stop(ctx.currentTime + 1.25);
}
</script>
</body>
</html>

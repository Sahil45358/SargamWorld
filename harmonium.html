<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SurSargam ‚Äì Harmonium</title>
  <style>
    body {
      margin: 0;
      font-family: 'Verdana', sans-serif;
      background: url('wood-texture.jpg') repeat;
      background-size: cover;
      color: #fff;
      text-align: center;
    }

    header, footer {
      padding: 1rem;
      background: rgba(0, 0, 0, 0.7);
    }

    main {
      padding: 2rem;
    }

    #noteDisplay {
      font-size: 1.4rem;
      color: #ffeb3b;
      margin-bottom: 1rem;
    }

    #harmonium-container {
      display: flex;
      justify-content: center;
      overflow-x: auto;
    }

    #harmonium {
      position: relative;
      display: flex;
      align-items: flex-end;
      height: 220px;
      padding: 0 10px;
    }

    .white-key {
      width: 40px;
      height: 200px;
      background: #fff8e1;
      border: 1px solid #5d4037;
      margin: 0 1px;
      border-radius: 0 0 5px 5px;
      position: relative;
      z-index: 1;
      box-shadow: inset 0 0 5px #aaa;
      display: flex;
      justify-content: center;
      align-items: flex-end;
      font-size: 0.75rem;
      font-weight: bold;
      cursor: pointer;
    }

    .white-key:hover {
      background: #fff3c1;
    }

    .black-key {
      position: absolute;
      width: 28px;
      height: 120px;
      background: #1b1b1b;
      z-index: 2;
      top: 0;
      border-radius: 0 0 4px 4px;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.4);
    }

    .black-key:active {
      background: #444;
    }

    a {
      color: #ffeb3b;
      text-decoration: none;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <header>
    <h1>üéπ SurSargam ‚Äì Harmonium</h1>
    <p>Click or hold any key to hear its pitch</p>
  </header>

  <main>
    <div id="noteDisplay">Click a key‚Ä¶</div>
    <div id="harmonium-container">
      <div id="harmonium"></div>
    </div>
    <p><a href="index.html">‚¨ÖÔ∏è Back to Home</a></p>
  </main>

  <footer>
    <p>üé∂ SurSargam ‚Ä¢ Interactive Harmonium ‚Ä¢ Octaves C2 to C4</p>
  </footer>

  <script>
    const harmonium = document.getElementById('harmonium');
    const display = document.getElementById('noteDisplay');
    const ctx = new (window.AudioContext || window.webkitAudioContext)();

    const whiteNotes = ['C', 'D', 'E', 'F', 'G', 'A', 'B'];
    const blackNotes = ['C#', 'D#', '', 'F#', 'G#', 'A#', ''];
    const semitoneSteps = {
      'C': 0, 'C#': 1, 'D': 2, 'D#': 3, 'E': 4,
      'F': 5, 'F#': 6, 'G': 7, 'G#': 8, 'A': 9, 'A#': 10, 'B': 11
    };

    const baseFreq = 65.41; // C2
    let whiteKeyCount = 0;

    for (let octave = 2; octave <= 4; octave++) {
      for (let i = 0; i < whiteNotes.length; i++) {
        const note = whiteNotes[i];
        const noteId = note + octave;

        const white = document.createElement('div');
        white.className = 'white-key';
        white.dataset.note = noteId;
        if (note === 'C') white.innerText = noteId;

        const step = semitoneSteps[note] + (octave - 2) * 12;
        const freq = baseFreq * Math.pow(2, step / 12);

        white.onmousedown = () => startNote(noteId, freq);
        white.onmouseup = stopNote;
        white.onmouseleave = stopNote;
        white.ontouchstart = (e) => { e.preventDefault(); startNote(noteId, freq); };
        white.ontouchend = stopNote;

        harmonium.appendChild(white);

        const blackNote = blackNotes[i];
        if (blackNote !== '') {
          const black = document.createElement('div');
          black.className = 'black-key';
          const blackNoteId = blackNote + octave;
          const blackStep = semitoneSteps[blackNote] + (octave - 2) * 12;
          const blackFreq = baseFreq * Math.pow(2, blackStep / 12);

          black.dataset.note = blackNoteId;

          const leftOffset = whiteKeyCount * 42 + 30;
          black.style.left = leftOffset + 'px';

          black.onmousedown = () => startNote(blackNoteId, blackFreq);
          black.onmouseup = stopNote;
          black.onmouseleave = stopNote;
          black.ontouchstart = (e) => { e.preventDefault(); startNote(blackNoteId, blackFreq); };
          black.ontouchend = stopNote;

          harmonium.appendChild(black);
        }

        whiteKeyCount++;
      }
    }

    let osc = null, gain = null;

    function startNote(label, frequency) {
      display.textContent = 'üéµ ' + label;
      osc = ctx.createOscillator();
      gain = ctx.createGain();

      osc.type = 'triangle'; // Richer tone
      osc.frequency.setValueAtTime(frequency, ctx.currentTime);
      gain.gain.setValueAtTime(0.3, ctx.currentTime);

      osc.connect(gain).connect(ctx.destination);
      osc.start();
    }

    function stopNote() {
      if (gain) gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.3);
      if (osc) osc.stop(ctx.currentTime + 0.4);
    }
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SurSargam ‚Äì Harmonium</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>üéπ SurSargam ‚Äì Harmonium (3 Saptak)</h1>
    <p>Click the keys to hear notes ‚Äì only C2, C3, and C4 are labeled</p>
  </header>

  <main class="harmonium-wrap">
    <div id="noteDisplay">Click a key‚Ä¶</div>
    <div class="harmonium" id="harmonium"></div>
    <p style="margin-top: 2rem;"><a href="index.html">‚¨ÖÔ∏è Back to Home</a></p>
  </main>

  <footer>
    <p>üé∂ SurSargam ‚Ä¢ Harmonium with interactive note playback</p>
  </footer>

  <script>
    const AudioCtx = window.AudioContext || window.webkitAudioContext;
    const ctx = new AudioCtx();
    const container = document.getElementById('harmonium');
    const noteDisplay = document.getElementById('noteDisplay');

    const notes = [
      'C2','C#2','D2','D#2','E2','F2','F#2','G2','G#2','A2','A#2','B2',
      'C3','C#3','D3','D#3','E3','F3','F#3','G3','G#3','A3','A#3','B3',
      'C4','C#4','D4','D#4','E4','F4','F#4','G4','G#4','A4','A#4','B4'
    ];

    notes.forEach(note => {
      const key = document.createElement('div');
      const isBlack = note.includes('#');
      key.className = isBlack ? 'black-key' : 'white-key';
      if (['C2', 'C3', 'C4'].includes(note)) key.textContent = note;
      key.onclick = () => playNote(note);
      container.appendChild(key);
    });

    function playNote(note) {
      const freq = noteToFrequency(note);
      noteDisplay.textContent = 'üéµ ' + note;
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.type = 'sine';
      osc.frequency.value = freq;
      gain.gain.setValueAtTime(0.001, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.4, ctx.currentTime + 0.01);
      gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.8);
      osc.connect(gain).connect(ctx.destination);
      osc.start();
      osc.stop(ctx.currentTime + 0.85);
    }

    function noteToFrequency(note) {
      const A4 = 440;
      const keys = ['C','C#','D','D#','E','F','F#','G','G#','A','A#','B'];
      const key = note.slice(0, -1);
      const octave = parseInt(note.slice(-1));
      const n = keys.indexOf(key) + (octave - 4) * 12;
      return A4 * Math.pow(2, (n - 9) / 12);
    }
  </script>
</body>
</html>

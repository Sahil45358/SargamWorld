<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bhatkhande Notation — SargamWorld</title>
  <link rel="icon" type="image/png" href="favicon.png" />

  <style>
    /* === THEME VARIABLES === */
    :root {
      --accent: #800000;      /* red theme */
      --bg: #f3eee8;
      --text: #222;
      --muted: #5a5a5a;
      --radius: 12px;
      --container-w: 1100px;
      --transition: 0.3s ease;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      line-height: 1.6;
    }

    a { text-decoration: none; color: inherit; }

    /* === NAVBAR === */
    .site-header {
      background: var(--accent);
      color: #fff;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      position: relative;
      z-index: 1000;
    }

    .nav-inner {
      max-width: var(--container-w);
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between; /* logo left, links right */
      gap: 12px;
      padding: 12px 20px;
      flex-wrap: wrap; /* allows wrapping on smaller screens */
    }

    .brand-wrap {
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 10px;
      flex-shrink: 0; /* prevent shrinking on PC */
    }

    .logo { display: flex; align-items: center; gap: 8px; font-weight:700; font-size:1.2rem; color:#fff; }
    .logo img { height: 120px; }

    .tagline {
      font-size: 0.8rem;
      font-weight: 400;
      color: #f3e8e8;
      display: inline-block;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .nav-links {
      display: flex;
      gap: 10px;
      list-style: none;
      margin-left: auto; /* push links to the right */
    }

    .nav-links a {
      color:#fff; padding:8px 12px; border-radius:8px; font-weight:600; transition: var(--transition);
    }
    .nav-links a:hover, .nav-links a:focus { background: rgba(255,255,255,0.1); }
    .nav-links a.active { background: rgba(255,255,255,0.15); }

    .hamburger {
      display: none;
      cursor: pointer;
      font-size: 1.6rem;
      color: #fff;
    }

    @media (pointer: coarse) {
      .logo span { display: none !important; }
    }
    @media (max-width: 1024px) {
      .logo span { display: none !important; }
    }
    @media (max-width: 768px) {
      .nav-links {
        display: none;
        flex-direction: column;
        background: var(--accent);
        position: absolute;
        top: 100px; right: 20px;
        padding: 15px;
        border-radius: 8px;
      }
      .nav-links.show { display: flex; }
      .hamburger { display: block; position: relative; z-index: 1100; }
      .tagline { font-size: 0.7rem; }
      .nav-links { margin-left: 0; }
    }

    /* === HERO === */
    .hero { text-align: center; margin-bottom: 30px; }
    .hero h1 { font-size: 2rem; color: var(--accent); margin-bottom: 10px; }
    .hero p { max-width: 720px; margin: 0 auto; color: var(--muted); line-height: 1.6; }

  /* Editor adjustments */
#editor {
  width: 100%;
  max-width: 800px;   /* ✅ limit maximum width on PC */
  min-width: 300px;   /* ✅ minimum width so it doesn't shrink too small on mobile */
  margin: 0 auto 20px auto; /* center the editor */
  min-height: 200px;  /* slightly smaller height */
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: var(--radius);
  padding: 12px;
  font-size: 1.2rem;  /* slightly smaller text for better fit */
  background: #fff;
  font-family: 'ome_bhatkhande_hindi', monospace;
  white-space: pre-wrap;
  word-wrap: break-word;
  overflow: auto;
}

/* Optional: even smaller on very small screens */
@media (max-width: 480px) {
  #editor {
    font-size: 1rem;
    min-height: 150px;
  }
}
    /* === KEYBOARD BUTTONS === */
    .keyboard button {
      background: #800000;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 8px 12px;
      margin: 3px;
      cursor: pointer;
      font-weight: 600;
      transition: 0.2s ease;
    }

    .keyboard button:hover {
      background: #9b1717;
      color: #fff;
    }

    .keyboard-section button {
      background: #800000;
      color: #fff;
    }
    .keyboard-section button:hover {
      background: #9b1717;
    }

    /* === FOOTER === */
    .site-footer { text-align: center; padding: 20px; color: var(--muted); font-size: 0.9rem; margin-top: 40px; }

  </style>

  <!-- Bhatkhande Web Font -->
  <link rel="stylesheet" href="https://webfonts.omenad.net/fonts.css">
</head>
<body>

<header class="site-header">
  <div class="nav-inner">
    <div class="brand-wrap">
      <a href="index.html" class="logo">
        <img src="LOGO.png" alt="SargamWorld Logo">
        <span>SargamWorld</span>
      </a>
      <span class="tagline">Explore • Learn • Practice</span>
    </div>

    <div class="hamburger">☰</div>

    <ul class="nav-links" id="navLinks">
      <li><a href="index.html">Home</a></li>
      <li><a href="songs.html">Songs</a></li>
      <li><a href="tools.html" class="active">Tools</a></li>
      <li><a href="about.html">About</a></li>
      <li><a href="contact.html">Contact</a></li>
      <li><a href="support.html">Support</a></li>
    </ul>
  </div>
</header>

<main class="container">
  <section class="hero">
    <h1>Bhatkhande Notation Editor</h1>
    <p>Type your composition using the Bhatkhande keyboard below and download as PDF.</p>
  </section>

  <div id="editor" contenteditable="true"></div>

  <div class="keyboard">
    <!-- Swars -->
    <div class="keyboard-section">
      <h4>Swars</h4>
      <button data-key="s">Sa (s)</button>
      <button data-key="r">Re (r)</button>
      <button data-key="R">Komal Re (R)</button>
      <button data-key="g">Ga (g)</button>
      <button data-key="G">Komal Ga (G)</button>
      <button data-key="m">Ma (m)</button>
      <button data-key="M">Teevra Ma (M)</button>
      <button data-key="p">Pa (p)</button>
      <button data-key="d">Dha (d)</button>
      <button data-key="D">Komal Dha (D)</button>
      <button data-key="n">Ni (n)</button>
      <button data-key="N">Komal Ni (N)</button>
    </div>

    <!-- Octaves -->
    <div class="keyboard-section">
      <h4>Octaves</h4>
      <button data-key="su">Taar Sa (su)</button>
      <button data-key="Nl">Mandra Komal Ni (Nl)</button>
      <button data-key="Mu">Taar Teevra Ma (Mu)</button>
    </div>

    <!-- Chhand -->
    <div class="keyboard-section">
      <h4>Chhand</h4>
      <button data-key="@">Dugun (2)</button>
      <button data-key="#">Tigun (3)</button>
      <button data-key="$">Chaugun (4)</button>
      <button data-key="%">Pachgun (5)</button>
      <button data-key="^">Chhatgun (6)</button>
      <button data-key="&">Satgun (7)</button>
      <button data-key="*">Athgun (8)</button>
      <button data-key="`">Lower Chaugun (4)</button>
      <button data-key="!">Lower Chhatgun (6)</button>
      <button data-key="~">Lower Athgun (8)</button>
    </div>

    <!-- Meend -->
    <div class="keyboard-section">
      <h4>Meend</h4>
      <button data-key="q">Start (q)</button>
      <button data-key="w">Continue (w)</button>
      <button data-key="e">End (e)</button>
      <button data-key="Q">Ghaseet Start (Q)</button>
      <button data-key="W">Stroke (W)</button>
      <button data-key="E">Ghaseet End (E)</button>
    </div>

    <!-- Murki -->
    <div class="keyboard-section">
      <h4>Murki</h4>
      <button data-key="(">( Start</button>
      <button data-key=")">) End</button>
    </div>

    <!-- Mizrab -->
    <div class="keyboard-section">
      <h4>Mizrab</h4>
      <button data-key=";">Da (;)</button>
      <button data-key="'">Ra (')</button>
      <button data-key="[">Daa ([)</button>
      <button data-key="]">Raa (])</button>
      <button data-key="\\">Dir (\)</button>
      <button data-key="-">Khali (-)</button>
    </div>

    <!-- Controls -->
    <div class="keyboard-section">
      <h4>Controls</h4>
      <button onclick="clearEditor()">Clear</button>
    </div>
  </div>

  <button id="downloadPDF" style="padding:10px 16px; background:var(--accent); color:#fff; border:none; border-radius:var(--radius); font-weight:600; cursor:pointer; margin-top:10px;">
    Download PDF
  </button>
</main>

<footer class="site-footer">
  <small>© 2025 SargamWorld — All rights reserved. <a href="privacy.html">Privacy</a> · <a href="terms.html">Terms</a></small>
</footer>

<!-- Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
  // Navbar toggle
  document.addEventListener("DOMContentLoaded", () => {
    const hamburger = document.querySelector(".hamburger");
    const navLinks = document.getElementById("navLinks");
    hamburger.addEventListener("click", () => navLinks.classList.toggle("show"));
  });

  // Keyboard input
  const buttons = document.querySelectorAll('.keyboard button');
  const editor = document.getElementById('editor');
  buttons.forEach(btn => {
    btn.addEventListener('click', () => {
      const key = btn.getAttribute('data-key');
      if(key) editor.innerText += key;
      editor.focus();
    });
  });

  function clearEditor() { editor.innerText = ""; }

  // Multi-page PDF download
  document.getElementById('downloadPDF').addEventListener('click', async () => {
    const doc = new jsPDF();
    const fontUrl = "https://omenad.github.io/fonts/ome-bhatkhande-hindi/ome_bhatkhande_hindi.woff";
    const fontBuffer = await fetch(fontUrl).then(r => r.arrayBuffer());

    doc.addFileToVFS("OmeBhatkhande.ttf", fontBuffer);
    doc.addFont("OmeBhatkhande.ttf", "OmeBhatkhande", "normal");
    doc.setFont("OmeBhatkhande");
    doc.setFontSize(16);

    const text = editor.innerText || "";
    const pageHeight = doc.internal.pageSize.getHeight();
    const margin = 15;
    const lineHeight = 10;
    let y = margin;

    const lines = doc.splitTextToSize(text, doc.internal.pageSize.getWidth() - 2 * margin);
    lines.forEach((line) => {
      if (y + lineHeight > pageHeight - margin) {
        doc.addPage();
        y = margin;
      }
      doc.text(line, margin, y);
      y += lineHeight;
    });

    doc.save("Bhatkhande-Composition.pdf");
  });
</script>

</body>
</html>
